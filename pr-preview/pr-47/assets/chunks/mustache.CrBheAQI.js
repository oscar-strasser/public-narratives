import{e as dt,I as Mn,m as Ae,t as F,aj as yt,ak as bt,b as pe,a4 as wn,a as Oe,h as be,U as qt,al as je,v as m,z as ke,am as Gn,f as pt,an as Zt,k as Et,a6 as H,S as Ht,H as Tn,ao as U,a7 as Xe,ap as Ye,G as xn,r as Fn,aq as Rn,q as vn,ar as Sn,J as S,j as Ln,u as Ue,l as De,E as We,as as Nn,a8 as In,x as An}from"./math.jhaqrn-c.js";function me(i,t,e){const n=e!==void 0?i.toFixed(e):""+i;let r=n.indexOf(".");return r=r===-1?n.length:r,r>t?n:new Array(1+t-r).join("0")+n}function Ir(i,t){const e=(""+i).split("."),n=(""+t).split(".");for(let r=0;r<Math.max(e.length,n.length);r++){const s=parseInt(e[r]||"0",10),o=parseInt(n[r]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function Ar(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function On(i,t){const e=i[0],n=i[1],r=t[0],s=t[1],o=r[0],a=r[1],l=s[0],h=s[1],c=l-o,u=h-a,f=c===0&&u===0?0:(c*(e-o)+u*(n-a))/(c*c+u*u||0);let g,y;return f<=0?(g=o,y=a):f>=1?(g=l,y=h):(g=o+f*c,y=a+f*u),[g,y]}function Or(i,t,e){const n=Ae(t+180,360)-180,r=Math.abs(3600*n),s=e||0;let o=Math.floor(r/3600),a=Math.floor((r-o*3600)/60),l=Mn(r-o*3600-a*60,s);l>=60&&(l=0,a+=1),a>=60&&(a=0,o+=1);let h=o+"°";return(a!==0||l!==0)&&(h+=" "+me(a,2)+"′"),l!==0&&(h+=" "+me(l,2,s)+"″"),n!==0&&(h+=" "+i.charAt(n<0?1:0)),h}function bn(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function br(i,t){const e=Math.cos(t),n=Math.sin(t),r=i[0]*e-i[1]*n,s=i[1]*e+i[0]*n;return i[0]=r,i[1]=s,i}function jr(i,t){return i[0]*=t,i[1]*=t,i}function $e(i,t){const e=i[0]-t[0],n=i[1]-t[1];return e*e+n*n}function kr(i,t){return Math.sqrt($e(i,t))}function Xr(i,t){return $e(i,On(i,t))}function Yr(i,t){if(t.canWrapX()){const e=dt(t.getExtent()),n=qe(i,t,e);n&&(i[0]-=n*e)}return i}function qe(i,t,e){const n=t.getExtent();let r=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||dt(n),r=Math.floor((i[0]-n[0])/e)),r}const Mt=63710088e-1;function jt(i,t,e){e=e||Mt;const n=F(i[1]),r=F(t[1]),s=(r-n)/2,o=F(t[0]-i[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Lt(i,t){let e=0;for(let n=0,r=i.length;n<r-1;++n)e+=jt(i[n],i[n+1],t);return e}function jn(i,t){t=t||{};const e=t.radius||Mt,n=t.projection||"EPSG:3857",r=i.getType();r!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let s=0,o,a,l,h,c,u;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":{o=i.getCoordinates(),s=Lt(o,e);break}case"MultiLineString":case"Polygon":{for(o=i.getCoordinates(),l=0,h=o.length;l<h;++l)s+=Lt(o[l],e);break}case"MultiPolygon":{for(o=i.getCoordinates(),l=0,h=o.length;l<h;++l)for(a=o[l],c=0,u=a.length;c<u;++c)s+=Lt(a[c],e);break}case"GeometryCollection":{const f=i.getGeometries();for(l=0,h=f.length;l<h;++l)s+=jn(f[l],t);break}default:throw new Error("Unsupported geometry type: "+r)}return s}function ct(i,t){let e=0;const n=i.length;let r=i[n-1][0],s=i[n-1][1];for(let o=0;o<n;o++){const a=i[o][0],l=i[o][1];e+=F(a-r)*(2+Math.sin(F(s))+Math.sin(F(l))),r=a,s=l}return e*t*t/2}function kn(i,t){t=t||{};const e=t.radius||Mt,n=t.projection||"EPSG:3857",r=i.getType();r!=="GeometryCollection"&&(i=i.clone().transform(n,"EPSG:4326"));let s=0,o,a,l,h,c,u;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":{for(o=i.getCoordinates(),s=Math.abs(ct(o[0],e)),l=1,h=o.length;l<h;++l)s-=Math.abs(ct(o[l],e));break}case"MultiPolygon":{for(o=i.getCoordinates(),l=0,h=o.length;l<h;++l)for(a=o[l],s+=Math.abs(ct(a[0],e)),c=1,u=a.length;c<u;++c)s-=Math.abs(ct(a[c],e));break}case"GeometryCollection":{const f=i.getGeometries();for(l=0,h=f.length;l<h;++l)s+=kn(f[l],t);break}default:throw new Error("Unsupported geometry type: "+r)}return s}function Xn(i,t,e,n){n=n||Mt;const r=F(i[1]),s=F(i[0]),o=t/n,a=Math.asin(Math.sin(r)*Math.cos(o)+Math.cos(r)*Math.sin(o)*Math.cos(e)),l=s+Math.atan2(Math.sin(e)*Math.sin(o)*Math.cos(r),Math.cos(o)-Math.sin(r)*Math.sin(a));return[yt(l),yt(a)]}function Yn(...i){console.warn(...i)}function Ur(...i){console.error(...i)}const Un={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function Dr(i){return Un[i]}const kt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Jt{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||kt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const st=6378137,Z=Math.PI*st,Dn=[-Z,-Z,Z,Z],Wn=[-180,-85,180,85],ut=st*Math.log(Math.tan(Math.PI/2));class $ extends Jt{constructor(t){super({code:t,units:"m",extent:Dn,global:!0,worldExtent:Wn,getPointResolution:function(e,n){return e/Math.cosh(n[1]/st)}})}}const _e=[new $("EPSG:3857"),new $("EPSG:102100"),new $("EPSG:102113"),new $("EPSG:900913"),new $("http://www.opengis.net/def/crs/EPSG/0/3857"),new $("http://www.opengis.net/gml/srs/epsg.xml#3857")];function $n(i,t,e,n){const r=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(r));for(let s=0;s<r;s+=n){t[s]=Z*i[s]/180;let o=st*Math.log(Math.tan(Math.PI*(+i[s+1]+90)/360));o>ut?o=ut:o<-ut&&(o=-ut),t[s+1]=o}return t}function qn(i,t,e,n){const r=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(r));for(let s=0;s<r;s+=n)t[s]=180*i[s]/Z,t[s+1]=360*Math.atan(Math.exp(i[s+1]/st))/Math.PI-90;return t}const Zn=6378137,Ce=[-180,-90,180,90],Hn=Math.PI*Zn/180;class I extends Jt{constructor(t,e){super({code:t,units:"degrees",extent:Ce,axisOrientation:e,global:!0,metersPerUnit:Hn,worldExtent:Ce})}}const Pe=[new I("CRS:84"),new I("EPSG:4326","neu"),new I("urn:ogc:def:crs:OGC:1.3:CRS84"),new I("urn:ogc:def:crs:OGC:2:84"),new I("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new I("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new I("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Xt={};function Jn(i){return Xt[i]||Xt[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Kn(i,t){Xt[i]=t}let J={};function b(i,t,e){const n=i.getCode(),r=t.getCode();n in J||(J[n]={}),J[n][r]=e}function Nt(i,t){return i in J&&t in J[i]?J[i][t]:null}const mt=.9996,R=.00669438,wt=R*R,Gt=wt*R,A=R/(1-R),Ee=Math.sqrt(1-R),K=(1-Ee)/(1+Ee),Ze=K*K,Kt=Ze*K,zt=Kt*K,He=zt*K,Je=1-R/4-3*wt/64-5*Gt/256,zn=3*R/8+3*wt/32+45*Gt/1024,Bn=15*wt/256+45*Gt/1024,Vn=35*Gt/3072,Qn=3/2*K-27/32*Kt+269/512*He,ti=21/16*Ze-55/32*zt,ei=151/96*Kt-417/128*He,ni=1097/512*zt,_t=6378137;function ii(i,t,e){const n=i-5e5,o=(e.north?t:t-1e7)/mt/(_t*Je),a=o+Qn*Math.sin(2*o)+ti*Math.sin(4*o)+ei*Math.sin(6*o)+ni*Math.sin(8*o),l=Math.sin(a),h=l*l,c=Math.cos(a),u=l/c,f=u*u,g=f*f,y=1-R*h,d=Math.sqrt(1-R*h),_=_t/d,P=(1-R)/y,p=A*c**2,w=p*p,M=n/(_*mt),G=M*M,L=G*M,ht=L*M,x=ht*M,Pn=x*M,En=a-u/P*(G/2-ht/24*(5+3*f+10*p-4*w-9*A))+Pn/720*(61+90*f+298*p+45*g-252*A-3*w);let St=(M-L/6*(1+2*f+p)+x/120*(5-2*p+28*f-3*w+8*A+24*g))/c;return St=bt(St+F(Ke(e.number)),-Math.PI,Math.PI),[yt(St),yt(En)]}const Me=-80,we=84,ri=-180,si=180;function oi(i,t,e){i=bt(i,ri,si),t<Me?t=Me:t>we&&(t=we);const n=F(t),r=Math.sin(n),s=Math.cos(n),o=r/s,a=o*o,l=a*a,h=F(i),c=Ke(e.number),u=F(c),f=_t/Math.sqrt(1-R*r**2),g=A*s**2,y=s*bt(h-u,-Math.PI,Math.PI),d=y*y,_=d*y,P=_*y,p=P*y,w=p*y,M=_t*(Je*n-zn*Math.sin(2*n)+Bn*Math.sin(4*n)-Vn*Math.sin(6*n)),G=mt*f*(y+_/6*(1-a+g)+p/120*(5-18*a+l+72*g-58*A))+5e5;let L=mt*(M+f*o*(d/2+P/24*(5-a+9*g+4*g**2)+w/720*(61-58*a+l+600*g-330*A)));return e.north||(L+=1e7),[G,L]}function Ke(i){return(i-1)*6-180+3}const ai=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function ze(i){let t=0;for(const r of ai){const s=i.match(r);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,n=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(n=!0,e=t-32600),e?{number:e,north:n}:null}function Ge(i,t){return function(e,n,r,s){const o=e.length;r=r>1?r:2,s=s??r,n||(r>2?n=e.slice():n=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],h=e[a+1],c=i(l,h,t);n[a]=c[0],n[a+1]=c[1]}return n}}function li(i){return ze(i)?new Jt({code:i,units:"m"}):null}function hi(i){const t=ze(i.getCode());return t?{forward:Ge(oi,t),inverse:Ge(ii,t)}:null}const ci=[hi],ui=[li];let Yt=!0;function fi(i){Yt=!1}function Bt(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function Wr(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function Ut(i){Kn(i.getCode(),i),b(i,i,Bt)}function gi(i){i.forEach(Ut)}function E(i){if(typeof i!="string")return i;const t=Jn(i);if(t)return t;for(const e of ui){const n=e(i);if(n)return n}return null}function $r(i,t,e,n){i=E(i);let r;const s=i.getPointResolutionFunc();if(s){if(r=s(t,e),n&&n!==i.getUnits()){const o=i.getMetersPerUnit();o&&(r=r*o/kt[n])}}else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")r=t;else{const a=Vt(i,E("EPSG:4326"));if(!a&&o!=="degrees")r=t*i.getMetersPerUnit();else{let h=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];h=a(h,h,2);const c=jt(h.slice(0,2),h.slice(2,4)),u=jt(h.slice(4,6),h.slice(6,8));r=(c+u)/2}const l=n?kt[n]:i.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function Te(i){gi(i),i.forEach(function(t){i.forEach(function(e){t!==e&&b(t,e,Bt)})})}function di(i,t,e,n){i.forEach(function(r){t.forEach(function(s){b(r,s,e),b(s,r,n)})})}function qr(i,t){return i?typeof i=="string"?E(i):i:E(t)}function xe(i){return function(t,e,n,r){const s=t.length;n=n!==void 0?n:2,r=r??n,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=r){const a=i(t.slice(o,o+n)),l=a.length;for(let h=0,c=r;h<c;++h)e[o+h]=h>=l?t[o+h]:a[h]}return e}}function Zr(i,t,e,n){const r=E(i),s=E(t);b(r,s,xe(e)),b(s,r,xe(n))}function Hr(i,t){return fi(),Ve(i,"EPSG:4326","EPSG:3857")}function Jr(i,t){const e=Ve(i,t!==void 0?t:"EPSG:3857","EPSG:4326"),n=e[0];return(n<-180||n>180)&&(e[0]=Ae(n+180,360)-180),e}function Be(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||Vt(i,t)===Bt)&&e}function Vt(i,t){const e=i.getCode(),n=t.getCode();let r=Nt(e,n);if(r)return r;let s=null,o=null;for(const l of ci)s||(s=l(i)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=It(s.inverse,o.forward);else{const l=Nt(e,a);l&&(r=It(l,o.forward))}else{const l=Nt(a,n);l&&(r=It(s.inverse,l))}return r&&(Ut(i),Ut(t),b(i,t,r)),r}function It(i,t){return function(e,n,r,s){return n=i(e,n,r,s),t(n,n,r,s)}}function Q(i,t){const e=E(i),n=E(t);return Vt(e,n)}function Ve(i,t,e){const n=Q(t,e);if(!n){const r=E(t).getCode(),s=E(e).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return n(i,void 0,i.length)}function yi(i,t,e,n){const r=Q(t,e);return wn(i,r,void 0,n)}let pi=null;function Kr(){return pi}function zr(i,t){return i}function Br(i,t){return Yt&&!bn(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Yt=!1,Yn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function Vr(i,t){return i}function Qr(i,t){return i}function ts(i,t,e){return function(n){let r,s;if(i.canWrapX()){const o=i.getExtent(),a=dt(o);n=n.slice(0),s=qe(n,i,a),s&&(n[0]=n[0]-s*a),n[0]=pe(n[0],o[0],o[2]),n[1]=pe(n[1],o[1],o[3]),r=e(n)}else r=e(n);return s&&t.canWrapX()&&(r[0]+=s*dt(t.getExtent())),r}}function mi(){Te(_e),Te(Pe),di(Pe,_e,$n,qn)}mi();const Qt=new Array(6);function Qe(){return[1,0,0,1,0,0]}function es(i){return Tt(i,1,0,0,1,0,0)}function te(i,t){const e=i[0],n=i[1],r=i[2],s=i[3],o=i[4],a=i[5],l=t[0],h=t[1],c=t[2],u=t[3],f=t[4],g=t[5];return i[0]=e*l+r*h,i[1]=n*l+s*h,i[2]=e*c+r*u,i[3]=n*c+s*u,i[4]=e*f+r*g+o,i[5]=n*f+s*g+a,i}function Tt(i,t,e,n,r,s,o){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i[4]=s,i[5]=o,i}function ns(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function is(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function rs(i,t){const e=Math.cos(t),n=Math.sin(t);return te(i,Tt(Qt,e,n,-n,e,0,0))}function ss(i,t,e){return te(i,Tt(Qt,t,0,0,e,0,0))}function os(i,t,e){return te(i,Tt(Qt,1,0,0,1,t,e))}function tn(i,t,e,n,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return i[0]=n*h,i[1]=r*l,i[2]=-n*l,i[3]=r*h,i[4]=o*n*h-a*n*l+t,i[5]=o*r*l+a*r*h+e,i}function as(i,t){const e=_i(t);Oe(e!==0,"Transformation matrix cannot be inverted");const n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return i[0]=o/e,i[1]=-r/e,i[2]=-s/e,i[3]=n/e,i[4]=(s*l-o*a)/e,i[5]=-(n*l-r*a)/e,i}function _i(i){return i[0]*i[3]-i[1]*i[2]}const Fe=[1e6,1e6,1e6,1e6,2,2];function ls(i){return"matrix("+i.map((e,n)=>Math.round(e*Fe[n])/Fe[n]).join(", ")+")"}function ee(i,t,e,n,r,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=n){const h=i[l],c=i[l+1];s[a++]=r[0]*h+r[2]*c+r[4],s[a++]=r[1]*h+r[3]*c+r[5];for(let u=2;u<o;u++)s[a++]=i[l+u]}return s&&s.length!=a&&(s.length=a),s}function Ci(i,t,e,n,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],c=s[1];let u=0;for(let f=t;f<e;f+=n){const g=i[f]-h,y=i[f+1]-c;o[u++]=h+g*a-y*l,o[u++]=c+g*l+y*a;for(let d=f+2;d<f+n;++d)o[u++]=i[d]}return o&&o.length!=u&&(o.length=u),o}function Pi(i,t,e,n,r,s,o,a){a=a||[];const l=o[0],h=o[1];let c=0;for(let u=t;u<e;u+=n){const f=i[u]-l,g=i[u+1]-h;a[c++]=l+r*f,a[c++]=h+s*g;for(let y=u+2;y<u+n;++y)a[c++]=i[y]}return a&&a.length!=c&&(a.length=c),a}function Ei(i,t,e,n,r,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=n){o[a++]=i[l]+r,o[a++]=i[l+1]+s;for(let h=l+2;h<l+n;++h)o[a++]=i[h]}return o&&o.length!=a&&(o.length=a),o}const Re=Qe(),Mi=[NaN,NaN];class en extends be{constructor(){super(),this.extent_=qt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=je((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return m()}closestPointXY(t,e,n,r){return m()}containsXY(t,e){return this.closestPointXY(t,e,Mi,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return m()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&ke(e),this.extentRevision_=this.getRevision()}return Gn(this.extent_,t)}rotate(t,e){m()}scale(t,e,n){m()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return m()}getType(){return m()}applyTransform(t){m()}intersectsExtent(t){return m()}translate(t,e){m()}transform(t,e){const n=E(t),r=n.getUnits()=="tile-pixels"?function(s,o,a){const l=n.getExtent(),h=n.getWorldExtent(),c=pt(h)/pt(l);tn(Re,h[0],h[3],c,-c,0,0,0);const u=ee(s,0,s.length,a,Re,o),f=Q(n,e);return f?f(u,u,a):u}:Q(n,e);return this.applyTransform(r),this}}class D extends en{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Zt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return m()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=ve(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){m()}setLayout(t,e,n){let r;if(t)r=ve(t);else{for(let s=0;s<n;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=W(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();Ci(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=Et(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Pi(r,0,r.length,s,t,e,n,r),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();Ei(n,0,n.length,r,t,e,n),this.changed()}}}function W(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function ve(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function hs(i,t,e){const n=i.getFlatCoordinates();if(!n)return null;const r=i.getStride();return ee(n,0,n.length,r,t,e)}function nn(i,t,e,n){let r=0;const s=i[e-n],o=i[e-n+1];let a=0,l=0;for(;t<e;t+=n){const h=i[t]-s,c=i[t+1]-o;r+=l*h-a*c,a=h,l=c}return r/2}function rn(i,t,e,n){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=nn(i,t,a,n),t=a}return r}function wi(i,t,e,n){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=rn(i,t,a,n),t=a[a.length-1]}return r}function Se(i,t,e,n,r,s,o){const a=i[t],l=i[t+1],h=i[e]-a,c=i[e+1]-l;let u;if(h===0&&c===0)u=t;else{const f=((r-a)*h+(s-l)*c)/(h*h+c*c);if(f>1)u=e;else if(f>0){for(let g=0;g<n;++g)o[g]=Ht(i[t+g],i[e+g],f);o.length=n;return}else u=t}for(let f=0;f<n;++f)o[f]=i[u+f];o.length=n}function ne(i,t,e,n,r){let s=i[t],o=i[t+1];for(t+=n;t<e;t+=n){const a=i[t],l=i[t+1],h=H(s,o,a,l);h>r&&(r=h),s=a,o=l}return r}function ie(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=ne(i,t,a,n,r),t=a}return r}function Gi(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=ie(i,t,a,n,r),t=a[a.length-1]}return r}function re(i,t,e,n,r,s,o,a,l,h,c){if(t==e)return h;let u,f;if(r===0){if(f=H(o,a,i[t],i[t+1]),f<h){for(u=0;u<n;++u)l[u]=i[t+u];return l.length=n,f}return h}c=c||[NaN,NaN];let g=t+n;for(;g<e;)if(Se(i,g-n,g,n,o,a,c),f=H(o,a,c[0],c[1]),f<h){for(h=f,u=0;u<n;++u)l[u]=c[u];l.length=n,g+=n}else g+=n*Math.max((Math.sqrt(f)-Math.sqrt(h))/r|0,1);if(s&&(Se(i,e-n,t,n,o,a,c),f=H(o,a,c[0],c[1]),f<h)){for(h=f,u=0;u<n;++u)l[u]=c[u];l.length=n}return h}function se(i,t,e,n,r,s,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const g=e[u];h=re(i,t,g,n,r,s,o,a,l,h,c),t=g}return h}function Ti(i,t,e,n,r,s,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,f=e.length;u<f;++u){const g=e[u];h=se(i,t,g,n,r,s,o,a,l,h,c),t=g[g.length-1]}return h}function xi(i,t,e,n){for(let r=0,s=e.length;r<s;++r)i[t++]=e[r];return t}function xt(i,t,e,n){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<n;++a)i[t++]=o[a]}return t}function ot(i,t,e,n,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=xt(i,t,e[o],n);r[s++]=l,t=l}return r.length=s,r}function sn(i,t,e,n,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=ot(i,t,e[o],n,r[s]);l.length===0&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function Ft(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=n)r[s++]=i.slice(o,o+n);return r.length=s,r}function oe(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=Ft(i,t,l,n,r[s]),t=l}return r.length=s,r}function Fi(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=l.length===1&&l[0]===t?[]:oe(i,t,l,n,r[s]),t=l[l.length-1]}return r.length=s,r}function Rt(i,t,e,n,r,s,o){const a=(e-t)/n;if(a<3){for(;t<e;t+=n)s[o++]=i[t],s[o++]=i[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[t,e-n];let c=0;for(;h.length>0;){const u=h.pop(),f=h.pop();let g=0;const y=i[f],d=i[f+1],_=i[u],P=i[u+1];for(let p=f+n;p<u;p+=n){const w=i[p],M=i[p+1],G=Tn(w,M,y,d,_,P);G>g&&(c=p,g=G)}g>r&&(l[(c-t)/n]=1,f+n<c&&h.push(f,c),c+n<u&&h.push(c,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=i[t+u*n],s[o++]=i[t+u*n+1]);return o}function on(i,t,e,n,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=Rt(i,t,c,n,r,s,o),a.push(o),t=c}return o}function q(i,t){return t*Math.round(i/t)}function Ri(i,t,e,n,r,s,o){if(t==e)return o;let a=q(i[t],r),l=q(i[t+1],r);t+=n,s[o++]=a,s[o++]=l;let h,c;do if(h=q(i[t],r),c=q(i[t+1],r),t+=n,t==e)return s[o++]=h,s[o++]=c,o;while(h==a&&c==l);for(;t<e;){const u=q(i[t],r),f=q(i[t+1],r);if(t+=n,u==h&&f==c)continue;const g=h-a,y=c-l,d=u-a,_=f-l;if(g*_==y*d&&(g<0&&d<g||g==d||g>0&&d>g)&&(y<0&&_<y||y==_||y>0&&_>y)){h=u,c=f;continue}s[o++]=h,s[o++]=c,a=h,l=c,h=u,c=f}return s[o++]=h,s[o++]=c,o}function ae(i,t,e,n,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=Ri(i,t,c,n,r,s,o),a.push(o),t=c}return o}function vi(i,t,e,n,r,s,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l],u=[];o=ae(i,t,c,n,r,s,o,u),a.push(u),t=c[c.length-1]}return o}class tt extends D{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new tt(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<U(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return nn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Rt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new tt(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xt(this.flatCoordinates,0,t,this.stride),this.changed()}}class j extends D{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new j(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const s=this.flatCoordinates,o=H(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)n[l]=s[l];return n.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Xe(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Ye(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xi(this.flatCoordinates,0,t,this.stride),this.changed()}}function Si(i,t,e,n,r){return!xn(r,function(o){return!O(i,t,e,n,o[0],o[1])})}function O(i,t,e,n,r,s){let o=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){const h=i[t],c=i[t+1];l<=s?c>s&&(h-a)*(s-l)-(r-a)*(c-l)>0&&o++:c<=s&&(h-a)*(s-l)-(r-a)*(c-l)<0&&o--,a=h,l=c}return o!==0}function le(i,t,e,n,r,s){if(e.length===0||!O(i,t,e[0],n,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(O(i,e[o-1],e[o],n,r,s))return!1;return!0}function Li(i,t,e,n,r,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(le(i,t,l,n,r,s))return!0;t=l[l.length-1]}return!1}function he(i,t,e,n,r,s,o){let a,l,h,c,u,f,g;const y=r[s+1],d=[];for(let p=0,w=e.length;p<w;++p){const M=e[p];for(c=i[M-n],f=i[M-n+1],a=t;a<M;a+=n)u=i[a],g=i[a+1],(y<=f&&g<=y||f<=y&&y<=g)&&(h=(y-f)/(g-f)*(u-c)+c,d.push(h)),c=u,f=g}let _=NaN,P=-1/0;for(d.sort(Fn),c=d[0],a=1,l=d.length;a<l;++a){u=d[a];const p=Math.abs(u-c);p>P&&(h=(c+u)/2,le(i,t,e,n,h,y)&&(_=h,P=p)),c=u}return isNaN(_)&&(_=r[s]),o?(o.push(_,y,P),o):[_,y,P]}function an(i,t,e,n,r){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=he(i,t,l,n,r,2*o,s),t=l[l.length-1]}return s}function ln(i,t,e,n,r){let s;for(t+=n;t<e;t+=n)if(s=r(i.slice(t-n,t),i.slice(t,t+n)),s)return s;return!1}function vt(i,t,e,n,r,s){return s=s??Rn(qt(),i,t,e,n),vn(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:ln(i,t,e,n,function(o,a){return Sn(r,o,a)}):!1}function Ni(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){if(vt(i,t,e[s],n,r))return!0;t=e[s]}return!1}function Ii(i,t,e,n,r){return!!(vt(i,t,e,n,r)||O(i,t,e,n,r[0],r[1])||O(i,t,e,n,r[0],r[3])||O(i,t,e,n,r[2],r[1])||O(i,t,e,n,r[2],r[3]))}function hn(i,t,e,n,r){if(!Ii(i,t,e[0],n,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(Si(i,e[s-1],e[s],n,r)&&!vt(i,e[s-1],e[s],n,r))return!1;return!0}function Ai(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(hn(i,t,a,n,r))return!0;t=a[a.length-1]}return!1}function Oi(i,t,e,n){for(;t<e-n;){for(let r=0;r<n;++r){const s=i[t+r];i[t+r]=i[e-n+r],i[e-n+r]=s}t+=n,e-=n}}function ce(i,t,e,n){let r=0,s=i[e-n],o=i[e-n+1];for(;t<e;t+=n){const a=i[t],l=i[t+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function ue(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=ce(i,t,a,n);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function cn(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!ue(i,t,a,n,r))return!1;a.length&&(t=a[a.length-1])}return!0}function Ct(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=ce(i,t,a,n);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&Oi(i,t,a,n),t=a}return t}function Dt(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s)t=Ct(i,t,e[s],n,r);return t}function bi(i,t){const e=[];let n=0,r=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=ce(i,n,l,2);if(s===void 0&&(s=h),h===s)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,n=l}return e}class N extends D{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?S(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new N(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<U(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ie(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),se(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return le(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return rn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ct(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,oe(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Et(this.getExtent());this.flatInteriorPoint_=he(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new j(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new tt(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],h=new tt(e.slice(s,l),t);r.push(h),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;ue(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ct(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=ae(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new N(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return hn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=ot(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function cs(i,t,e,n){e=e||32;const r=[];for(let s=0;s<e;++s)S(r,Xn(i,t,2*Math.PI*s/e,n));return r.push(r[0],r[1]),new N(r,"XY",[r.length])}function us(i){if(Ln(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],n=i[2],r=i[3],s=[t,e,t,r,n,r,n,e,t,e];return new N(s,"XY",[s.length])}class z extends be{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new z(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ue(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=De(t,We.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?ji(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function ji(i){if(typeof i=="function")return i;let t;return Array.isArray(i)?t=i:(Oe(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[i]),function(){return t}}function un(i,t,e,n){const r=[];let s=qt();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Zt(i,t,l[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}function Pt(i,t,e,n,r,s,o){let a,l;const h=(e-t)/n;if(h===1)a=t;else if(h===2)a=t,l=r;else if(h!==0){let c=i[t],u=i[t+1],f=0;const g=[0];for(let _=t+n;_<e;_+=n){const P=i[_],p=i[_+1];f+=Math.sqrt((P-c)*(P-c)+(p-u)*(p-u)),g.push(f),c=P,u=p}const y=r*f,d=Nn(g,y);d<0?(l=(y-g[-d-2])/(g[-d-1]-g[-d-2]),a=t+(-d-2)*n):a=t+d*n}o=o>1?o:2,s=s||new Array(o);for(let c=0;c<o;++c)s[c]=a===void 0?NaN:l===void 0?i[a+c]:Ht(i[a+c],i[a+n+c],l);return s}function Wt(i,t,e,n,r,s){if(e==t)return null;let o;if(r<i[t+n-1])return s?(o=i.slice(t,t+n),o[n-1]=r,o):null;if(i[e-1]<r)return s?(o=i.slice(e-n,e),o[n-1]=r,o):null;if(r==i[t+n-1])return i.slice(t,t+n);let a=t/n,l=e/n;for(;a<l;){const f=a+l>>1;r<i[(f+1)*n-1]?l=f:a=f+1}const h=i[a*n-1];if(r==h)return i.slice((a-1)*n,(a-1)*n+n);const c=i[(a+1)*n-1],u=(r-h)/(c-h);o=[];for(let f=0;f<n-1;++f)o.push(Ht(i[(a-1)*n+f],i[a*n+f],u));return o.push(r),o}function ki(i,t,e,n,r,s,o){if(o)return Wt(i,t,e[e.length-1],n,r,s);let a;if(r<i[n-1])return s?(a=i.slice(0,n),a[n-1]=r,a):null;if(i[i.length-1]<r)return s?(a=i.slice(i.length-n),a[n-1]=r,a):null;for(let l=0,h=e.length;l<h;++l){const c=e[l];if(t!=c){if(r<i[t+n-1])return null;if(r<=i[c-1])return Wt(i,t,c,n,r,!1);t=c}}return null}class k extends en{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ue),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,n=t.length;e<n;++e)this.changeEventsKeys_.push(De(t[e],We.CHANGE,this.changed,this))}clone(){const t=new k(At(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,n,r){if(r<U(this.getExtent(),t,e))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(t,e,n,r);return r}containsXY(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)if(n[r].containsXY(t,e))return!0;return!1}computeExtent(t){ke(t);const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)In(t,e[n].getExtent());return t}getGeometries(){return At(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let r=!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(r=!0)}return r?new k(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].rotate(t,e);this.changed()}scale(t,e,n){n||(n=Et(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(At(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function At(i){return i.map(t=>t.clone())}function Xi(i,t,e,n){let r=i[t],s=i[t+1],o=0;for(let a=t+n;a<e;a+=n){const l=i[a],h=i[a+1];o+=Math.sqrt((l-r)*(l-r)+(h-s)*(h-s)),r=l,s=h}return o}class X extends D{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){S(this.flatCoordinates,t),this.changed()}clone(){const t=new X(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<U(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),re(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,r))}forEachSegment(t){return ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,Wt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Pt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Xi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Rt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new X(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return vt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xt(this.flatCoordinates,0,t,this.stride),this.changed()}}class et extends D{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const r=t,s=[],o=[];for(let l=0,h=r.length;l<h;++l){const c=r[l];S(s,c.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){S(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new et(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<U(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ie(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),se(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,r))}getCoordinateAtM(t,e,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,n=n!==void 0?n:!1,ki(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return oe(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new X(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,r=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new X(t.slice(s,l),n);r.push(h),s=l}return r}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],h=Pt(e,n,l,s,.5);S(t,h),n=l}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=on(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new et(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return Ni(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=ot(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}class at extends D{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){S(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new at(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){if(r<U(this.getExtent(),t,e))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const h=H(t,e,s[a],s[a+1]);if(h<r){r=h;for(let c=0;c<o;++c)n[c]=s[a+c];n.length=o}}return r}getCoordinates(){return Ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new j(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,r=[];for(let s=0,o=t.length;s<o;s+=n){const a=new j(t.slice(s,s+n),e);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let r=0,s=e.length;r<s;r+=n){const o=e[r],a=e[r+1];if(Ye(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xt(this.flatCoordinates,0,t,this.stride),this.changed()}}class nt extends D{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const r=t,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const h=r[a],c=s.length,u=h.getEnds();for(let f=0,g=u.length;f<g;++f)u[f]+=c;S(s,h.getFlatCoordinates()),o.push(u)}e=r.length===0?this.getLayout():r[0].getLayout(),t=s,n=o}e!==void 0&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;S(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=n}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const n=new nt(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,r){return r<U(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Gi(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ti(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return Li(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return wi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Dt(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Fi(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=un(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=an(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new at(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;cn(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Dt(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=vi(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new nt(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const n=this.endss_[t].slice(),r=n[n.length-1];if(e!==0)for(let s=0,o=n.length;s<o;++s)n[s]-=e;return new N(this.flatCoordinates.slice(e,r),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o].slice(),h=l[l.length-1];if(s!==0)for(let u=0,f=l.length;u<f;++u)l[u]-=s;const c=new N(e.slice(s,h),t,l);r.push(c),s=h}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return Ai(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=sn(this.flatCoordinates,0,t,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const r=n[n.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const Le=Qe();class Y{constructor(t,e,n,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Xe(this.flatCoordinates_):Zt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Et(this.getExtent());this.flatInteriorPoints_=he(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=bi(this.flatCoordinates_,this.ends_),e=un(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=an(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Pt(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let r=0,s=n.length;r<s;++r){const o=n[r],a=Pt(t,e,o,2,.5);S(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=E(t);const e=t.getExtent(),n=t.getWorldExtent();if(e&&n){const r=pt(n)/pt(e);tn(Le,n[0],n[3],r,-r,0,0,0),ee(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Le,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new Y(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=je((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":n.length=Rt(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),r=[n.length];break;case"MultiLineString":r=[],n.length=on(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,r);break;case"Polygon":r=[],n.length=ae(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,r);break}return r&&(this.simplifiedGeometry_=new Y(this.type_,n,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}Y.prototype.getFlatCoordinates=Y.prototype.getOrientedFlatCoordinates;class fn{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=z,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?E(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()==="tile-pixels"&&(n=E(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return m()}readFeature(t,e){return m()}readFeatures(t,e){return m()}readGeometry(t,e){return m()}readProjection(t){return m()}writeFeature(t,e){return m()}writeFeatures(t,e){return m()}writeGeometry(t,e){return m()}}function it(i,t,e){const n=e?E(e.featureProjection):null,r=e?E(e.dataProjection):null;let s=i;if(n&&r&&!Be(n,r)){t&&(s=i.clone());const o=t?n:r,a=t?r:n;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Q(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,c=l.length;h<c;++h)l[h]=Math.round(l[h]*o)/o;return l};s===i&&(s=i.clone()),s.applyTransform(a)}return s}function fs(i,t){const e=t?E(t.featureProjection):null,n=t?E(t.dataProjection):null;return e&&n&&!Be(e,n)?yi(i,n,e):i}const Yi={Point:j,LineString:X,Polygon:N,MultiPoint:at,MultiLineString:et,MultiPolygon:nt};function Ui(i,t,e){return Array.isArray(t[0])?(cn(i,0,t,e)||(i=i.slice(),Dt(i,0,t,e)),i):(ue(i,0,t,e)||(i=i.slice(),Ct(i,0,t,e)),i)}function gn(i,t){var s;const e=i.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>gn({...i,geometry:o})).flat();const n=e.type==="MultiPolygon"?"Polygon":e.type;if(n==="GeometryCollection"||n==="Circle")throw new Error("Unsupported geometry type: "+n);const r=e.layout.length;return it(new Y(n,n==="Polygon"?Ui(e.flatCoordinates,e.ends,r):e.flatCoordinates,(s=e.ends)==null?void 0:s.flat(),r,i.properties||{},i.id).enableSimplifyTransformed(),!1,t)}function fe(i,t){if(!i)return null;if(Array.isArray(i)){const n=i.map(r=>fe(r,t));return new k(n)}const e=Yi[i.type];return it(new e(i.flatCoordinates,i.layout||"XY",i.ends),!1,t)}class Di extends fn{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(ft(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(ft(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return m()}readFeaturesFromObject(t,e){return m()}readGeometry(t,e){return this.readGeometryFromObject(ft(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return m()}readProjection(t){return this.readProjectionFromObject(ft(t))}readProjectionFromObject(t){return m()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return m()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return m()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return m()}}function ft(i){if(typeof i=="string"){const t=JSON.parse(i);return t||null}return i!==null?i:null}class gs extends Di{constructor(t){t=t||{},super(),this.dataProjection=E(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=E(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;t.type==="Feature"?n=t:n={type:"Feature",geometry:t,properties:null};const r=ge(n.geometry);if(this.featureClass===Y)return gn({geometry:r,id:n.id,properties:n.properties},e);const s=new z;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&n.geometry_name&&s.setGeometryName(n.geometry_name),s.setGeometry(fe(r,e)),"id"in n&&s.setId(n.id),n.properties&&s.setProperties(n.properties,!0),s}readFeaturesFromObject(t,e){const n=t;let r=null;if(n.type==="FeatureCollection"){const s=t;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const h=this.readFeatureFromObject(o[a],e);h&&r.push(h)}}else r=[this.readFeatureFromObject(t,e)];return r.flat()}readGeometryFromObject(t,e){return Wi(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if(e.type=="name")n=E(e.properties.name);else if(e.type==="EPSG")n=E("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},r=t.getId();if(r!==void 0&&(n.id=r),!t.hasProperties())return n;const s=t.getProperties(),o=t.getGeometry();return o&&(n.geometry=$t(o,e),delete s[t.getGeometryName()]),An(s)||(n.properties=s),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let r=0,s=t.length;r<s;++r)n.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return $t(t,this.adaptOptions(e))}}function ge(i,t){if(!i)return null;let e;switch(i.type){case"Point":{e=qi(i);break}case"LineString":{e=Zi(i);break}case"Polygon":{e=zi(i);break}case"MultiPoint":{e=Ji(i);break}case"MultiLineString":{e=Hi(i);break}case"MultiPolygon":{e=Ki(i);break}case"GeometryCollection":{e=$i(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return e}function Wi(i,t){const e=ge(i);return fe(e,t)}function $i(i,t){return i.geometries.map(function(n){return ge(n)})}function qi(i){const t=i.coordinates;return{type:"Point",flatCoordinates:t,layout:W(t.length)}}function Zi(i){var n;const t=i.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:W(((n=t[0])==null?void 0:n.length)||2)}}function Hi(i){var s,o;const t=i.coordinates,e=((o=(s=t[0])==null?void 0:s[0])==null?void 0:o.length)||2,n=[],r=ot(n,0,t,e);return{type:"MultiLineString",flatCoordinates:n,ends:r,layout:W(e)}}function Ji(i){var e;const t=i.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:W(((e=t[0])==null?void 0:e.length)||2)}}function Ki(i){var s,o;const t=i.coordinates,e=[],n=((o=(s=t[0])==null?void 0:s[0])==null?void 0:o[0].length)||2,r=sn(e,0,t,n);return{type:"MultiPolygon",flatCoordinates:e,ends:r,layout:W(n)}}function zi(i){var s,o;const t=i.coordinates,e=[],n=(o=(s=t[0])==null?void 0:s[0])==null?void 0:o.length,r=ot(e,0,t,n);return{type:"Polygon",flatCoordinates:e,ends:r,layout:W(n)}}function $t(i,t){i=it(i,!0,t);const e=i.getType();let n;switch(e){case"Point":{n=nr(i);break}case"LineString":{n=Vi(i);break}case"Polygon":{n=ir(i,t);break}case"MultiPoint":{n=tr(i);break}case"MultiLineString":{n=Qi(i);break}case"MultiPolygon":{n=er(i,t);break}case"GeometryCollection":{n=Bi(i,t);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return n}function Bi(i,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(n){return $t(n,t)})}}function Vi(i,t){return{type:"LineString",coordinates:i.getCoordinates()}}function Qi(i,t){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function tr(i,t){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function er(i,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(e)}}function nr(i,t){return{type:"Point",coordinates:i.getCoordinates()}}function ir(i,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(e)}}class rr extends fn{constructor(){super()}getType(){return"text"}readFeature(t,e){return this.readFeatureFromText(gt(t),this.adaptOptions(e))}readFeatureFromText(t,e){return m()}readFeatures(t,e){return this.readFeaturesFromText(gt(t),this.adaptOptions(e))}readFeaturesFromText(t,e){return m()}readGeometry(t,e){return this.readGeometryFromText(gt(t),this.adaptOptions(e))}readGeometryFromText(t,e){return m()}readProjection(t){return this.readProjectionFromText(gt(t))}readProjectionFromText(t){return this.dataProjection}writeFeature(t,e){return this.writeFeatureText(t,this.adaptOptions(e))}writeFeatureText(t,e){return m()}writeFeatures(t,e){return this.writeFeaturesText(t,this.adaptOptions(e))}writeFeaturesText(t,e){return m()}writeGeometry(t,e){return this.writeGeometryText(t,this.adaptOptions(e))}writeGeometryText(t,e){return m()}}function gt(i){return typeof i=="string"?i:""}const sr={POINT:j,LINESTRING:X,POLYGON:N,MULTIPOINT:at,MULTILINESTRING:et,MULTIPOLYGON:nt},dn="EMPTY",yn="Z",pn="M",or="ZM",C={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},ar={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"};class lr{constructor(t){this.wkt=t,this.index_=-1}isAlpha_(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}isNumeric_(t,e){return e=e!==void 0?e:!1,t>="0"&&t<="9"||t=="."&&!e}isWhiteSpace_(t){return t==" "||t=="	"||t=="\r"||t==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){const t=this.nextChar_(),e=this.index_;let n=t,r;if(t=="(")r=C.LEFT_PAREN;else if(t==",")r=C.COMMA;else if(t==")")r=C.RIGHT_PAREN;else if(this.isNumeric_(t)||t=="-")r=C.NUMBER,n=this.readNumber_();else if(this.isAlpha_(t))r=C.TEXT,n=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(t==="")r=C.EOF;else throw new Error("Unexpected character: "+t)}return{position:e,value:n,type:r}}readNumber_(){let t;const e=this.index_;let n=!1,r=!1;do t=="."?n=!0:(t=="e"||t=="E")&&(r=!0),t=this.nextChar_();while(this.isNumeric_(t,n)||!r&&(t=="e"||t=="E")||r&&(t=="-"||t=="+"));return parseFloat(this.wkt.substring(e,this.index_--))}readText_(){let t;const e=this.index_;do t=this.nextChar_();while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}class hr{constructor(t){this.lexer_=t,this.token_={position:0,type:C.START},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(t){return this.token_.type==t}match(t){const e=this.isTokenType(t);return e&&this.consume_(),e}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let t="XY";const e=this.token_;if(this.isTokenType(C.TEXT)){const n=e.value;n===yn?t="XYZ":n===pn?t="XYM":n===or&&(t="XYZM"),t!=="XY"&&this.consume_()}return t}parseGeometryCollectionText_(){if(this.match(C.LEFT_PAREN)){const t=[];do t.push(this.parseGeometry_());while(this.match(C.COMMA));if(this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match(C.LEFT_PAREN)){const t=this.parsePoint_();if(this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match(C.LEFT_PAREN)){const t=this.parsePointList_();if(this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match(C.LEFT_PAREN)){const t=this.parseLineStringTextList_();if(this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match(C.LEFT_PAREN)){let t;if(this.token_.type==C.LEFT_PAREN?t=this.parsePointTextList_():t=this.parsePointList_(),this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match(C.LEFT_PAREN)){const t=this.parseLineStringTextList_();if(this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match(C.LEFT_PAREN)){const t=this.parsePolygonTextList_();if(this.match(C.RIGHT_PAREN))return t}throw new Error(this.formatErrorMessage_())}parsePoint_(){const t=[],e=this.layout_.length;for(let n=0;n<e;++n){const r=this.token_;if(this.match(C.NUMBER))t.push(r.value);else break}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}parsePointList_(){const t=[this.parsePoint_()];for(;this.match(C.COMMA);)t.push(this.parsePoint_());return t}parsePointTextList_(){const t=[this.parsePointText_()];for(;this.match(C.COMMA);)t.push(this.parsePointText_());return t}parseLineStringTextList_(){const t=[this.parseLineStringText_()];for(;this.match(C.COMMA);)t.push(this.parseLineStringText_());return t}parsePolygonTextList_(){const t=[this.parsePolygonText_()];for(;this.match(C.COMMA);)t.push(this.parsePolygonText_());return t}isEmptyGeometry_(){const t=this.isTokenType(C.TEXT)&&this.token_.value==dn;return t&&this.consume_(),t}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){const t=this.token_;if(this.match(C.TEXT)){const e=t.value;this.layout_=this.parseGeometryLayout_();const n=this.isEmptyGeometry_();if(e=="GEOMETRYCOLLECTION"){if(n)return new k([]);const o=this.parseGeometryCollectionText_();return new k(o)}const r=sr[e];if(!r)throw new Error("Invalid geometry type: "+e);let s;if(n)e=="POINT"?s=[NaN,NaN]:s=[];else switch(e){case"POINT":{s=this.parsePointText_();break}case"LINESTRING":{s=this.parseLineStringText_();break}case"POLYGON":{s=this.parsePolygonText_();break}case"MULTIPOINT":{s=this.parseMultiPointText_();break}case"MULTILINESTRING":{s=this.parseMultiLineStringText_();break}case"MULTIPOLYGON":{s=this.parseMultiPolygonText_();break}}return new r(s,this.layout_)}throw new Error(this.formatErrorMessage_())}}class ds extends rr{constructor(t){super(),t=t||{},this.splitCollection_=t.splitCollection!==void 0?t.splitCollection:!1}parse_(t){const e=new lr(t);return new hr(e).parse()}readFeatureFromText(t,e){const n=this.readGeometryFromText(t,e),r=new z;return r.setGeometry(n),r}readFeaturesFromText(t,e){let n=[];const r=this.readGeometryFromText(t,e);this.splitCollection_&&r.getType()=="GeometryCollection"?n=r.getGeometriesArray():n=[r];const s=[];for(let o=0,a=n.length;o<a;++o){const l=new z;l.setGeometry(n[o]),s.push(l)}return s}readGeometryFromText(t,e){const n=this.parse_(t);return it(n,!1,e)}writeFeatureText(t,e){const n=t.getGeometry();return n?this.writeGeometryText(n,e):""}writeFeaturesText(t,e){if(t.length==1)return this.writeFeatureText(t[0],e);const n=[];for(let s=0,o=t.length;s<o;++s)n.push(t[s].getGeometry());const r=new k(n);return this.writeGeometryText(r,e)}writeGeometryText(t,e){return Cn(it(t,!0,e))}}function mn(i){const t=i.getCoordinates();return t.length===0?"":t.join(" ")}function cr(i){const t=[],e=i.getPoints();for(let n=0,r=e.length;n<r;++n)t.push("("+mn(e[n])+")");return t.join(",")}function ur(i){const t=[],e=i.getGeometries();for(let n=0,r=e.length;n<r;++n)t.push(Cn(e[n]));return t.join(",")}function de(i){const t=i.getCoordinates(),e=[];for(let n=0,r=t.length;n<r;++n)e.push(t[n].join(" "));return e.join(",")}function fr(i){const t=[],e=i.getLineStrings();for(let n=0,r=e.length;n<r;++n)t.push("("+de(e[n])+")");return t.join(",")}function _n(i){const t=[],e=i.getLinearRings();for(let n=0,r=e.length;n<r;++n)t.push("("+de(e[n])+")");return t.join(",")}function gr(i){const t=[],e=i.getPolygons();for(let n=0,r=e.length;n<r;++n)t.push("("+_n(e[n])+")");return t.join(",")}function dr(i){const t=i.getLayout();let e="";return(t==="XYZ"||t==="XYZM")&&(e+=yn),(t==="XYM"||t==="XYZM")&&(e+=pn),e}const yr={Point:mn,LineString:de,Polygon:_n,MultiPoint:cr,MultiLineString:fr,MultiPolygon:gr,GeometryCollection:ur};function Cn(i){const t=i.getType(),e=yr[t],n=e(i);let r=ar[t];if(typeof i.getFlatCoordinates=="function"){const s=dr(i);s.length>0&&(r+=" "+s)}return n.length===0?r+" "+dn:r+"("+n+")"}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var pr=Object.prototype.toString,V=Array.isArray||function(t){return pr.call(t)==="[object Array]"};function ye(i){return typeof i=="function"}function mr(i){return V(i)?"array":typeof i}function Ot(i){return i.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Ne(i,t){return i!=null&&typeof i=="object"&&t in i}function _r(i,t){return i!=null&&typeof i!="object"&&i.hasOwnProperty&&i.hasOwnProperty(t)}var Cr=RegExp.prototype.test;function Pr(i,t){return Cr.call(i,t)}var Er=/\S/;function Mr(i){return!Pr(Er,i)}var wr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Gr(i){return String(i).replace(/[&<>"'`=\/]/g,function(e){return wr[e]})}var Tr=/\s*/,xr=/\s+/,Ie=/\s*=/,Fr=/\s*\}/,Rr=/#|\^|\/|>|\{|&|=|!/;function vr(i,t){if(!i)return[];var e=!1,n=[],r=[],s=[],o=!1,a=!1,l="",h=0;function c(){if(o&&!a)for(;s.length;)delete r[s.pop()];else s=[];o=!1,a=!1}var u,f,g;function y(x){if(typeof x=="string"&&(x=x.split(xr,2)),!V(x)||x.length!==2)throw new Error("Invalid tags: "+x);u=new RegExp(Ot(x[0])+"\\s*"),f=new RegExp("\\s*"+Ot(x[1])),g=new RegExp("\\s*"+Ot("}"+x[1]))}y(t||v.tags);for(var d=new lt(i),_,P,p,w,M,G;!d.eos();){if(_=d.pos,p=d.scanUntil(u),p)for(var L=0,ht=p.length;L<ht;++L)w=p.charAt(L),Mr(w)?(s.push(r.length),l+=w):(a=!0,e=!0,l+=" "),r.push(["text",w,_,_+1]),_+=1,w===`
`&&(c(),l="",h=0,e=!1);if(!d.scan(u))break;if(o=!0,P=d.scan(Rr)||"name",d.scan(Tr),P==="="?(p=d.scanUntil(Ie),d.scan(Ie),d.scanUntil(f)):P==="{"?(p=d.scanUntil(g),d.scan(Fr),d.scanUntil(f),P="&"):p=d.scanUntil(f),!d.scan(f))throw new Error("Unclosed tag at "+d.pos);if(P==">"?M=[P,p,_,d.pos,l,h,e]:M=[P,p,_,d.pos],h++,r.push(M),P==="#"||P==="^")n.push(M);else if(P==="/"){if(G=n.pop(),!G)throw new Error('Unopened section "'+p+'" at '+_);if(G[1]!==p)throw new Error('Unclosed section "'+G[1]+'" at '+_)}else P==="name"||P==="{"||P==="&"?a=!0:P==="="&&y(p)}if(c(),G=n.pop(),G)throw new Error('Unclosed section "'+G[1]+'" at '+d.pos);return Lr(Sr(r))}function Sr(i){for(var t=[],e,n,r=0,s=i.length;r<s;++r)e=i[r],e&&(e[0]==="text"&&n&&n[0]==="text"?(n[1]+=e[1],n[3]=e[3]):(t.push(e),n=e));return t}function Lr(i){for(var t=[],e=t,n=[],r,s,o=0,a=i.length;o<a;++o)switch(r=i[o],r[0]){case"#":case"^":e.push(r),n.push(r),e=r[4]=[];break;case"/":s=n.pop(),s[5]=r[2],e=n.length>0?n[n.length-1][4]:t;break;default:e.push(r)}return t}function lt(i){this.string=i,this.tail=i,this.pos=0}lt.prototype.eos=function(){return this.tail===""};lt.prototype.scan=function(t){var e=this.tail.match(t);if(!e||e.index!==0)return"";var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};lt.prototype.scanUntil=function(t){var e=this.tail.search(t),n;switch(e){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,e),this.tail=this.tail.substring(e)}return this.pos+=n.length,n};function B(i,t){this.view=i,this.cache={".":this.view},this.parent=t}B.prototype.push=function(t){return new B(t,this)};B.prototype.lookup=function(t){var e=this.cache,n;if(e.hasOwnProperty(t))n=e[t];else{for(var r=this,s,o,a,l=!1;r;){if(t.indexOf(".")>0)for(s=r.view,o=t.split("."),a=0;s!=null&&a<o.length;)a===o.length-1&&(l=Ne(s,o[a])||_r(s,o[a])),s=s[o[a++]];else s=r.view[t],l=Ne(r.view,t);if(l){n=s;break}r=r.parent}e[t]=n}return ye(n)&&(n=n.call(this.view)),n};function T(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}T.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};T.prototype.parse=function(t,e){var n=this.templateCache,r=t+":"+(e||v.tags).join(":"),s=typeof n<"u",o=s?n.get(r):void 0;return o==null&&(o=vr(t,e),s&&n.set(r,o)),o};T.prototype.render=function(t,e,n,r){var s=this.getConfigTags(r),o=this.parse(t,s),a=e instanceof B?e:new B(e,void 0);return this.renderTokens(o,a,n,t,r)};T.prototype.renderTokens=function(t,e,n,r,s){for(var o="",a,l,h,c=0,u=t.length;c<u;++c)h=void 0,a=t[c],l=a[0],l==="#"?h=this.renderSection(a,e,n,r,s):l==="^"?h=this.renderInverted(a,e,n,r,s):l===">"?h=this.renderPartial(a,e,n,s):l==="&"?h=this.unescapedValue(a,e):l==="name"?h=this.escapedValue(a,e,s):l==="text"&&(h=this.rawValue(a)),h!==void 0&&(o+=h);return o};T.prototype.renderSection=function(t,e,n,r,s){var o=this,a="",l=e.lookup(t[1]);function h(f){return o.render(f,e,n,s)}if(l){if(V(l))for(var c=0,u=l.length;c<u;++c)a+=this.renderTokens(t[4],e.push(l[c]),n,r,s);else if(typeof l=="object"||typeof l=="string"||typeof l=="number")a+=this.renderTokens(t[4],e.push(l),n,r,s);else if(ye(l)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");l=l.call(e.view,r.slice(t[3],t[5]),h),l!=null&&(a+=l)}else a+=this.renderTokens(t[4],e,n,r,s);return a}};T.prototype.renderInverted=function(t,e,n,r,s){var o=e.lookup(t[1]);if(!o||V(o)&&o.length===0)return this.renderTokens(t[4],e,n,r,s)};T.prototype.indentPartial=function(t,e,n){for(var r=e.replace(/[^ \t]/g,""),s=t.split(`
`),o=0;o<s.length;o++)s[o].length&&(o>0||!n)&&(s[o]=r+s[o]);return s.join(`
`)};T.prototype.renderPartial=function(t,e,n,r){if(n){var s=this.getConfigTags(r),o=ye(n)?n(t[1]):n[t[1]];if(o!=null){var a=t[6],l=t[5],h=t[4],c=o;l==0&&h&&(c=this.indentPartial(o,h,a));var u=this.parse(c,s);return this.renderTokens(u,e,n,c,r)}}};T.prototype.unescapedValue=function(t,e){var n=e.lookup(t[1]);if(n!=null)return n};T.prototype.escapedValue=function(t,e,n){var r=this.getConfigEscape(n)||v.escape,s=e.lookup(t[1]);if(s!=null)return typeof s=="number"&&r===v.escape?String(s):r(s)};T.prototype.rawValue=function(t){return t[1]};T.prototype.getConfigTags=function(t){return V(t)?t:t&&typeof t=="object"?t.tags:void 0};T.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!V(t))return t.escape};var v={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(i){rt.templateCache=i},get templateCache(){return rt.templateCache}},rt=new T;v.clearCache=function(){return rt.clearCache()};v.parse=function(t,e){return rt.parse(t,e)};v.render=function(t,e,n,r){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+mr(t)+'" was given as the first argument for mustache#render(template, view, partials)');return rt.render(t,e,n,r)};v.escape=Gr;v.Scanner=lt;v.Context=B;v.Writer=T;export{me as $,te as A,Ft as B,oe as C,Fi as D,q as E,ns as F,Xi as G,Kr as H,ls as I,Or as J,Be as K,z as L,kt as M,j as N,X as O,N as P,jn as Q,Y as R,D as S,kn as T,gs as U,Di as V,it as W,nt as X,et as Y,at as Z,fn as _,Qr as a,k as a0,Jn as a1,Ut as a2,Jt as a3,Nt as a4,Te as a5,Zr as a6,ts as a7,Ve as a8,yi as a9,$e as aa,kr as ab,ve as ac,On as ad,Xr as ae,Hr as af,xt as ag,ce as ah,tt as ai,fs as aj,en as ak,rr as al,bi as am,Ir as an,ds as ao,os as ap,$r as aq,xe as ar,es as as,ss as at,rs as au,Ii as av,Ur as aw,Dr as ax,Jr as ay,v as az,Ar as b,qr as c,Vr as d,us as e,Br as f,bn as g,fi as h,tn as i,Qe as j,is as k,Yn as l,as as m,xi as n,Ci as o,Wr as p,Vt as q,br as r,jr as s,zr as t,E as u,cs as v,Yr as w,Q as x,ee as y,hs as z};
