import{aK as q,aL as R,aM as K,p as j,h as G,ah as H,aq as L,q as U,v as W,c as I,o as y,G as k,aN as J,w as g,j as C,at as D,e as x,b as S,k as f,K as _,W as Q,C as X,aO as O,ae as Z}from"./framework.hObu1goC.js";import{u as ee,l as M,d as P,a as te,m as ae,V as A,b as T,c as E,e as F,_ as ne,i as se,f as V,g as Y}from"./eo-dash.CqjNF9IV.js";import{V as oe}from"./VTooltip-BMsliOuh.VKrd-SAF.js";import"./commonjsHelpers.BosuxZz1.js";import"./VOverlay-BS-E4Z6g.DsE4FCwf.js";import"./forwardRefs-lhDuXD-N.frVc_BNq.js";import"./transition-DHEuQX4I.B5JMvFc7.js";function re(t,r){const u=typeof t=="string"?X(t):t,n=le(u,r);return{mounted:n,updated:n,unmounted(d){O(null,d)}}}function le(t,r){return function(u,n,d){var m,w,o;const c=typeof r=="function"?r(n):r,h=((m=n.value)==null?void 0:m.text)??n.value??(c==null?void 0:c.text),v=se(n.value)?n.value:{},l=()=>h??u.textContent,i=(d.ctx===n.instance.$?(w=ie(d,n.instance.$))==null?void 0:w.provides:(o=d.ctx)==null?void 0:o.provides)??n.instance.$.provides,b=Z(t,_(c,v),l);b.appContext=Object.assign(Object.create(null),n.instance.$.appContext,{provides:i}),O(b,u)}}function ie(t,r){const u=new Set,n=c=>{var h,v;for(const l of c){if(!l)continue;if(l===t||l.el&&t.el&&l.el===t.el)return!0;u.add(l);let i;if(l.suspense?i=n([l.ssContent]):Array.isArray(l.children)?i=n(l.children):(h=l.component)!=null&&h.vnode&&(i=n([(v=l.component)==null?void 0:v.subTree])),i)return i;u.delete(l)}return!1};if(!n([r.subTree]))return r;const d=Array.from(u).reverse();for(const c of d)if(c.component)return c.component;return r}const $=re(oe,t=>{var r;return{activator:"parent",location:(r=t.arg)==null?void 0:r.replace("-"," "),text:typeof t.value=="boolean"?void 0:t.value}}),de={ref:"rootRef",class:"datePicker"},ce={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ue={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},fe=["value"],me={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},pe={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ye=["value"],Ce={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(t){q(o=>({f4706d8a:w.value}));const{lgAndDown:r}=ee(),u=R("rootRef"),n=R("datePicker"),d=K((o,e)=>({get(){return o(),new Date(P.value).getTime()},set(s){var p;e(),M.debug("Datepicker setting currentDate",P.value);const a=new Date(s);P.value=a.toISOString(),(p=n.value)==null||p.move({month:a.getMonth()+1,year:a.getFullYear()})}})),c=j({input:"YYYY-MM-DD"}),h=o=>{const e=o.getFullYear(),s=o.getMonth()+1,a=o.getDate();return`${e}-${s<10?"0"+s:s}-${a<10?"0"+a:a}`},v=o=>{var e;d.value=new Date((e=o.target)==null?void 0:e.value).getTime()},l=G(()=>h(new Date(d.value))),i=H([]),b=L(te(),"selectedStac");U(b,async(o,e)=>{var s;if(o&&(e==null?void 0:e.id)!==o.id){M.debug("Datepicker selected STAC change triggered"),i.splice(0,i.length);for(let a=0;a<V.length;a++){M.debug("Retrieving dates",V[a]),await V[a].fetchCollection();const p=[...new Set((s=V[a].getItems())==null?void 0:s.reduce((z,N)=>{const B=Date.parse(N.datetime);return B&&z.push(new Date(B)),z},[]))];i.push({key:"id-"+a.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:Y[a%Y.length]}},dates:p,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function m(o){if(i.length){let e=o?1/0:-1/0;i.forEach(s=>{s!=null&&s.dates&&s.dates.forEach(a=>{a instanceof Date&&(e=Math[o?"min":"max"](e,a.getTime()))})}),d.value=e===-1/0?Date.now():e===1/0?0:e}}const w=j("");return W(()=>{w.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),ae(u),(o,e)=>(y(),I("div",de,[k(f(ne),{ref:"datePicker",modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=s=>d.value=s),modelModifiers:{number:!0},attributes:i,masks:c.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},J({_:2},[t.toggleCalendar?{name:"default",fn:g(({inputValue:s,inputEvents:a})=>[C("div",ce,[t.hideArrows?x("v-if",!0):D((y(),S(A,{key:0,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=p=>m(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(T,{icon:[f(E)]},null,8,["icon"])]),_:1},8,["size"])),[[$,"Set date to oldest available dataset","bottom"]]),C("div",ue,[t.hideInputField?x("v-if",!0):(y(),I("input",_({key:0,value:s},Q(a,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,fe))]),t.hideArrows?x("v-if",!0):D((y(),S(A,{key:1,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=p=>m(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(T,{icon:[f(F)]},null,8,["icon"])]),_:1},8,["size"])),[[$,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:g(()=>[C("div",me,[t.hideArrows?x("v-if",!0):D((y(),S(A,{key:0,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=s=>m(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(T,{icon:[f(E)]},null,8,["icon"])]),_:1},8,["size"])),[[$,"Set date to oldest available dataset","bottom"]]),C("div",pe,[t.hideInputField?x("v-if",!0):(y(),I("input",{key:0,value:l.value,onChange:v,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,ye))]),t.hideArrows?x("v-if",!0):D((y(),S(A,{key:1,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=s=>m(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(T,{icon:[f(F)]},null,8,["icon"])]),_:1},8,["size"])),[[$,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{Ce as default};
